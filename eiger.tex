\documentclass[a4paper,
               %boxit,
               %titlepage,   % separate title page
               %refpage      % separate references
              ]{jacow}

\makeatletter%                           % test for XeTeX where the sequence is by default eps-> pdf, jpg, png, pdf, ...
\ifboolexpr{bool{xetex}}                 % and the JACoW template provides JACpic2v3.eps and JACpic2v3.jpg which might generates errors
 {\renewcommand{\Gin@extensions}{.pdf,%
                    .png,.jpg,.bmp,.pict,.tif,.psd,.mac,.sga,.tga,.gif,%
                    .eps,.ps,%
                    }}{}
\makeatother

\ifboolexpr{bool{xetex} or bool{luatex}} % test for XeTeX/LuaTeX
 {}                                      % input encoding is utf8 by default
 {\usepackage[utf8]{inputenc}}           % switch to utf8

\usepackage[USenglish]{babel}


\ifboolexpr{bool{jacowbiblatex}}%        % if BibLaTeX is used
 {%
  \addbibresource{jacow-test.bib}
  \addbibresource{biblatex-examples.bib}
 }{}

\newcommand\SEC[1]{\textbf{\uppercase{#1}}}

%%
%%   Lengths for the spaces in the title
%%   \setlength\titleblockstartskip{..}  %before title, default 3pt
%%   \setlength\titleblockmiddleskip{..} %between title + author, default 1em
%%   \setlength\titleblockendskip{..}    %afterauthor, default 1em

%\copyrightspace %default 1cm. arbitrary size with e.g. \copyrightspace[2cm]

% testing to fill the copyright space
%\usepackage{eso-pic}
%\AddToShipoutPictureFG*{\AtTextLowerLeft{\textcolor{red}{COPYRIGHTSPACE}}}

\begin{document}

\title{Verification of the Neutron Mirror Capabilities in MCNPX via Gold Foil Measurements at the EIGER Instrument Beamline at the Swiss Spallation Neutron Source (SINQ) \thanks{Work supported by Swiss National Fund}}

\author{R.M. Bergmann \thanks{ryan.bergmann@psi.ch}, U. Filges, S. Forss, D. Reggiani, \\ E. Rantsiou, T. Reiss, U. Stuhr, V. Talanov, M. Wohlmuther \\ Paul Scherrer Institut, Villigen, Switzerland\\}

\maketitle

%
\begin{abstract}
   The EIGER triple-axis thermal neutron spectrometer beamline contains “supermirror” neutron guides, which preferentially reflect low-energy neutrons toward the EIGER spectrometer that come from the ambient temperature, light water neutron source in SINQ.  Gold foil and neutron imaging plate measurements have been performed at the EIGER beamline in 2013.  This process can be modeled from incident proton to thermal neutron exiting the EIGER beamline by using the neutron mirror capabilities of MCNPX, which should be more accurate than simulations with simplified neutron source distributions and geometry representations.  The supermirror reflectivity parameters have been measured previously, and these parameters are used in MCNPX 2.7.0 to reproduce the activation measured from the gold foil irradiation, verifying the neutron mirror modeling capabilities in MCNPX 2.7.0.
\end{abstract}


\section{Introduction}

EIGER is a triple-axis thermal neutron spectrometer that looks at the light water scatterer inside SINQ, a spallation neutron source driven by a continuous 590 MeV proton beam at the Paul Scherrer Institut in Villigen, Switzerland.  The incoming protons impinge on a lead target cooled with heavy water, producing high energy neutrons.  These neutrons are moderated by the tank of D$_2$O surrounding the target.  The ``water scatterer'' is a set of seven vertical aluminum tubes 25 cm away from the center of the target that contain ambient temperature light water.  These tubes act as a scattering medium to send thermal neutrons streaming through evacuated nozzles towards neutron instruments.  

The neutron guide that extracts thermal neutrons from the water scatterer towards the EIGER instrument is covered in neutron ``supermirrors'' internally.  These mirrors are reflective to low-energy neutrons, and allow the guide to transport neutrons with small divergence instead of only neutrons with trajectories parallel to the guide axis, increasing neutron extraction efficiency.  The reflectivity of the mirrors are described by Eq. \ref{eq:ref} where $R_0$ is nominal reflectivity, $Q_c$ is the critical momentum transfer, $m$ is the extension parameter, $\alpha$ is reflectivity declination parameter, and $W$ is is the reflectivity edge width \cite{mcnpx-ref}.

\begin{equation}\label{eq:ref}
R(Q) = 
\begin{cases}
    \mbox{if } Q > Q_c : \\
    \frac{R_0}{2}\left\{  1 - \tanh\left(  \frac{Q - m Q_c}{W}\right) \right\}\{1-\alpha(Q-Q_c)\} \\
    \\
    \mbox{if } Q \leq Q_c :\\
    R_0 \\
\end{cases}
\end{equation}

The reflectivity parameters of EIGER's supermirrors have been measured previously and determined to be $R_0=0.995$, $Q_c=2.17\times10^{-2}\AA^{-1}$, $m=3.6$, $\alpha=3.99 \AA$, and $W=10^{-3} \AA^{-1}$ \cite{eiger-uwe}.  The guide is rectangular, tapers in the horizontal plane from 80 mm wide near the moderator tank to 30 mm wide at the guide exit, and is a constant 150 mm tall in the vertical plane.  There is a 10 cm thick sapphire crystal near the moderator tank to preferentially scatter neutrons above 0.5 eV out of the beam.

This reflectivity model is used by McStas and has been previously implemented in patched version of MCNPX 2.5.0 \cite{mcnpx-ref}.  The patch has recently been ported to MCNPX 2.7.0 and debugged for MPI parallelism \cite{mcnpx270}.  The parallelized reflectivity capabilities now allow the neutron flux gains to be completely modeled in MCNPX 2.7.0.  This capability is demonstrated by comparing the calculated activation of an array of gold foils exposed to the EIGER beam to experimental results.

\section{Gold Foil Measurement}

The vertical array of six gold foils shown in Figure \ref{foils} were exposed to the EIGER beam on December, 2013.   

\begin{figure}[!htb]
   \centering
   \includegraphics*[width=35mm]{graphics/foils.eps}
   \caption{Gold foil array used in the measurements.}
   \label{foils}
\end{figure}

The foils were placed near the monochromator position at EIGER, near the center of its shielding.  The foils are 25 mm in diameter and 30 mm center-to-center.  The blue marker lines in the figure show the approximate extent of the neutron guide.  The average current on the SINQ target during the irradiation was $200 \mu A$, and the foils were exposed for 5 minutes.  The foils were allowed to decay for four days, then their activity was measured and back-corrected to midnight of that morning.


\section{MCNPX 2.7.0 Simulation}

The MCNPX model geometry is shown in Figure \ref{geom}.  The major components are the lead target, the moderator tank, the water scatterer, the in-tank nozzles, the sapphire crystal, the neutron guide, and the shielding around SINQ and EIGER.  The MCNPX simulation used the relevant S($\alpha$,$\beta$) data, including those for the crystal sapphire \cite{sapp}.  The MCNPX model for the water scatterer were created from the CAD models using the MCAM interface code developed by the FDS Team, China \cite{mcam}.


\begin{figure}[!htb]
   \centering
   \includegraphics*[trim = 0mm 25mm 0mm 10mm, width=65mm]{graphics/geom.pdf}
   \caption{MCNPX geometry highlighting the important elements of the neutron path to the measurement point.}
   \label{geom}
\end{figure}

The total fraction of neutrons that make it to EIGER from the target is small ($\sim 2 \times 10^{-6}$ per proton), and the low absorption means neutrons undergo many thousands of interactions before they are lost, on average.  This required that multiple variance reduction techniques be used in MCNPX.  The first technique used was mesh-based neutron weight windows.  A spherical mesh centered around the water scatterer with fine divisions at small radii and in the direction of the target was used.  The values of the mesh were optimized based on the response of a point detector tally at the measurement position.  Point detectors are not able to capture the reflectivity effects since they estimate non-interaction along a straight line.  Therefore, neutrons had to be propagated down the guide using a DXTRAN sphere.  The sphere was placed around the sapphire crystal before the guide section to force a fraction of the neutron weight to be placed at the sphere radius.  A surface source was then written from the downstream surface of the sapphire crystal.  The calculated spatial distributions of the thermal neutron current within a 5$^\circ$ cone normal to the water scatterer and the sapphire crystal are shown in Figures \ref{wsdist} and \ref{sappdist}, respectively.  The SINQ target is on the left side in both figures.



\begin{figure}[!htb]
   \centering
   \includegraphics*[trim = 0mm 8mm 0mm 1.5mm, width=65mm]{graphics/wsdist.pdf}
   \caption{The thermal neutron current distribution of the water scatterer in a 5$^\circ$ cone normal to its EIGER-facing surface.}
   \label{wsdist}
\end{figure}

\begin{figure}[!htb]
   \centering
   \includegraphics*[trim = 0mm 8mm 0mm 2.5mm, width=65mm]{graphics/sappdist.pdf}
   \caption{The thermal neutron current distribution in a 5$^\circ$ cone downstream of the sapphire crystal filter.}
   \label{sappdist}
\end{figure}

The post-sapphire distribution was used as the source term in a set of subsequent calculations with the neutron guide reflectivity turned on and off.  The surface source was sampled repeatedly with different initial random number seeds in order to capture the full weight variance of the sapphire surface source at the measurement point.  Much effort was made to keep the simulatiuons as high-fidelity as possible; no spectral or spatial approximations were made with regard to the neutron population, and no geometrical simplificaitons were knowingly made.

\section{Activation Results}

The neutron energy spectrum at the measurement point was calculated with 128 equi-log bins from $10^{-12}$ to 600 MeV for cases with the guide reflectivity turn on and off.  The spectra and reflectivity gain factors from these two sets of calculations are shown in Figure \ref{gain}.  

%trim option's parameter order: left bottom right top
\begin{figure}[!htb]
   \centering
   \includegraphics*[trim = 0mm 5mm 0mm 5mm, width=80mm]{graphics/gain.pdf}
   \caption{Top: The average spectra at the gold foil irradiation position with the guide reflectivity turned on and off in MCNPX.  Bottom: The energy dependence of the reflectivity gain.}
   \label{gain}
\end{figure}

The reflectivity gain goes above unity below 200 meV, and increases to 2.5 at 3 meV.  Below 3 meV, the statistics of the simulation start to become unreliable.  The gold (n,$\gamma$) macroscopic cross section was then averaged to the same binning as the spectra, multiplied by the spectra, and summed to determine the total reaction rate in the gold foils per incident proton on the SINQ target.  This was done at each gold foil position.  The aforementioned experimental irradiation and cooling parameters were then used to calculate the specific activity in the foils.  The results are shown in Figure \ref{activation}.

\begin{figure}[!htb]
   \centering
   \includegraphics*[trim = 0mm 5mm 15mm 25mm, width=83mm]{graphics/GF_act.pdf}
   \caption{Top: The measure activation of the gold foils and the calculated activation with reflectivity on and off.  Middle:  The gain factors over the calculated activation with reflectivity off.  Bottom:  The relative difference in gain between the measured values and the ideal reflectivity case.}
   \label{activation}
\end{figure}

It can be seen that the calculated activation values bracket the measured values, and that the highest gain factor is in the vertical center of the guide opening.  The lower plot in Figure \ref{activation} shows the relative difference of the ideal and measured gain factors.  The flux is about 50\% of the ideal value at the vertical center of the guide, and about equal to the non-reflective case at the top and bottom of the guide.  The average value is 20\% if the -7.5 cm value is not considered.


\section{Conclusion}

The caluclated results confirm that reflective neutron guides can now be completely modeled in MCNPX 2.7.0, and indicate that the EIGER supermirrors are operating at 20\% of ``ideal'' capacity.  

\section{acknowledgment}

This work was supported by Swiss National Fund.

\begin{thebibliography}{9}   % Use for  1-9  references
%\begin{thebibliography}{99} % Use for 10-99 references

\bibitem{mcnpx-ref}
  F. X. Gallmeier, M. Wohlmuther, U. Filges, D. Kiselev, G. Muhrer,
  ``Implementation of Neutron Mirror Modeling Capability into MCNPX and Its Demonstration in First Applications'',
  Nuclear Technology Vol. 168 No. 3, December 2009, pp 768-772. 

\bibitem{eiger-uwe}
  U. Filges, S. N. Gvasaliya, H.M. Ronnow, J. Birk,
  ``Monte Carlo Simulations for the new EIGER spectrometer at PSI'',
  4th European Conference on Neutron Scattering, 25-29 June, 2007, Lund, Sweden. 

\bibitem{mcnpx270}
   D.B. Pelowitz,
   ``MCNPX Manual, Version 2.7.0'',
   La-Cp-11-00438, April, 2011.

\bibitem{sapp}
  F. Cantargi, J.R. Granada, R.E. Mayer, 
  ``Thermal neutron scattering kernels for sapphire and silicon single crystals'', 
  Annals of Nuclear Energy 80, 2015, pp 43–46.  

\bibitem{mcam}
  Y. Wu, FDS Team, 
  ``CAD-based interface programs for fusion neutron transport simulation'', 
  Fusion Engineering and Design 84, 2009, 1987–1992.








\end{thebibliography}


\end{document}